<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seller Dashboard | B2B Surplus Marketplace</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
/* ===== ORIGINAL STYLES (UNCHANGED) ===== */
:root {
  --primary:#0d6efd;
  --success:#198754;
  --danger:#dc3545;
  --dark:#212529;
  --gray:#6c757d;
  --light:#f8f9fa;
  --bg:#f0f4f8;
  --card-bg:#ffffff;
  --border:#e0e0e0;
}
* { box-sizing:border-box; margin:0; padding:0; }
body {
  font-family:'Inter',sans-serif;
  background:var(--bg);
  color:var(--dark);
  line-height:1.6;
}
.container { max-width:1400px; margin:auto; padding:0 1rem; }

header {
  padding:1.5rem 0;
  border-bottom:1px solid var(--border);
  margin-bottom:2rem;
}
.header-top {
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.logo {
  font-size:1.5rem;
  font-weight:700;
  color:var(--primary);
  text-decoration:none;
}
.auth-buttons a {
  padding:.5rem 1rem;
  border:1px solid var(--primary);
  color:var(--primary);
  border-radius:50px;
  text-decoration:none;
  font-weight:600;
}

.nav-links {
  display:flex;
  justify-content:center;
  gap:2rem;
  margin:1.5rem 0;
}
.nav-links a {
  color:var(--dark);
  text-decoration:none;
  font-weight:500;
}

h1 {
  text-align:center;
  font-size:2.5rem;
  margin-bottom:.5rem;
}
.subtitle {
  text-align:center;
  color:var(--gray);
}

/* Dashboard */
.dashboard-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:2rem;
}
.btn-add {
  background:var(--success);
  color:#fff;
  padding:.75rem 1.5rem;
  border:none;
  border-radius:50px;
  font-weight:600;
  cursor:pointer;
}

.form-card {
  background:#fff;
  padding:2rem;
  border-radius:1rem;
  box-shadow:0 4px 16px rgba(0,0,0,.08);
  margin-bottom:2rem;
}
.form-grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:1.25rem;
}
.form-group { display:flex; flex-direction:column; }
label { margin-bottom:.5rem; font-weight:500; }
input, select {
  padding:.75rem 1rem;
  border-radius:50px;
  border:1px solid var(--border);
}

.listings-grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(320px,1fr));
  gap:1.5rem;
}
.listing-card {
  background:#fff;
  border-radius:1rem;
  overflow:hidden;
  box-shadow:0 4px 16px rgba(0,0,0,.08);
}
.listing-img img {
  width:100%;
  height:180px;
  object-fit:cover;
}
.listing-body {
  padding:1.25rem;
}
.listing-title {
  font-size:1.25rem;
  font-weight:600;
}
.listing-meta {
  color:var(--gray);
  font-size:.875rem;
}
.listing-fee {
  margin:.5rem 0;
  font-weight:600;
}
.listing-actions {
  display:flex;
  gap:.75rem;
}
.btn-edit { background:#ffc107; }
.btn-delete { background:var(--danger); color:#fff; }

.hidden { display:none; }

footer {
  background:var(--dark);
  color:#fff;
  padding:2rem 0;
  margin-top:4rem;
}
</style>
</head>

<body>

<div class="container">
<header>
  <div class="header-top">
    <a href="browse.html" class="logo">B2B Surplus</a>
    <div class="auth-buttons">
      <a href="#" id="signOutBtn">Sign Out</a>
    </div>
  </div>

  <nav class="nav-links">
    <a href="browse.html">Browse Listings</a>
    <a href="admin.html">Admin</a>
    <a href="contact-dispute-accordion.html">Contact Us</a>
  </nav>

  <h1>Seller Dashboard</h1>
  <p class="subtitle">Manage your surplus inventory listings.</p>
</header>

<div class="dashboard-header">
  <h2>Your Listings</h2>
  <button id="toggleFormBtn" class="btn-add">Add New Listing</button>
</div>

<form id="listingForm" class="form-card hidden">
  <div class="form-grid">
    <div class="form-group">
      <label>Item Name</label>
      <input id="name" required>
    </div>
    <div class="form-group">
      <label>Sector</label>
      <select id="sector">
        <option>Healthcare</option>
        <option>Manufacturing</option>
        <option>Retail</option>
        <option>Hospitality</option>
        <option>Other</option>
      </select>
    </div>
    <div class="form-group">
      <label>Condition</label>
      <select id="condition">
        <option>New</option>
        <option>Used - Like New</option>
        <option>Used - Good</option>
        <option>Used - Fair</option>
      </select>
    </div>
    <div class="form-group">
      <label>Price (£)</label>
      <input id="price" type="number" required>
    </div>
    <div class="form-group">
      <label>Quantity</label>
      <input id="quantity" type="number" value="1">
    </div>
    <div class="form-group">
      <label>Contact Info</label>
      <input id="contact" required>
    </div>
  </div>

  <button type="submit" class="btn-add" style="margin-top:1rem;">Save Listing</button>
</form>

<div id="listingsContainer" class="listings-grid"></div>
</div>

<footer>
  <div class="container">
    © 2025 B2B Surplus. All rights reserved.
  </div>
</footer>

<!-- ===== FIREBASE LOGIC ===== -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import {
  getFirestore, collection, addDoc, query, where,
  getDocs, deleteDoc, doc, serverTimestamp
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCrbAWZAiUuIfhwrPC0xa8WPTsVGJWDy1c",
  authDomain: "business2business-67222.firebaseapp.com",
  projectId: "business2business-67222",
  storageBucket: "business2business-67222.firebasestorage.app",
  messagingSenderId: "913722719592",
  appId: "1:913722719592:web:9d54f832b102e4d842aadd"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let currentUser = null;

onAuthStateChanged(auth, user => {
  if (!user) location.href = "signin.html";
  currentUser = user;
  loadListings();
});

document.getElementById("signOutBtn").onclick = async () => {
  await signOut(auth);
  location.href = "signin.html";
};

async function loadListings() {
  const q = query(collection(db, "listings"), where("ownerId", "==", currentUser.uid));
  const snap = await getDocs(q);
  const container = document.getElementById("listingsContainer");
  container.innerHTML = "";

  snap.forEach(d => {
    const l = d.data();
    container.innerHTML += `
      <div class="listing-card">
        <div class="listing-img">
          <img src="https://via.placeholder.com/300x180">
        </div>
        <div class="listing-body">
          <div class="listing-title">${l.name}</div>
          <div class="listing-meta">${l.sector} • ${l.condition}</div>
          <div class="listing-fee">£${l.price}</div>
          <button class="btn-delete" onclick="deleteListing('${d.id}')">Delete</button>
        </div>
      </div>`;
  });
}

window.deleteListing = async id => {
  if (!confirm("Delete this listing?")) return;
  await deleteDoc(doc(db, "listings", id));
  loadListings();
};

document.getElementById("toggleFormBtn").onclick = () =>
  document.getElementById("listingForm").classList.toggle("hidden");

document.getElementById("listingForm").onsubmit = async e => {
  e.preventDefault();
  await addDoc(collection(db, "listings"), {
    ownerId: currentUser.uid,
    name: name.value,
    sector: sector.value,
    condition: condition.value,
    price: +price.value,
    quantity: +quantity.value,
    contact: contact.value,
    createdAt: serverTimestamp()
  });
  e.target.reset();
  e.target.classList.add("hidden");
  loadListings();
};
</script>

</body>
</html>
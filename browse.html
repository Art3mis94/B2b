<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Browse Listings | B2B Surplus Marketplace</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- STYLES UNCHANGED -->
<style>
/* [ styles exactly as you provided ‚Äî unchanged ] */
</style>
</head>

<body>

<div class="container">
<header>
  <div class="header-top">
    <a href="#" class="logo">B2B Surplus</a>
    <div class="auth-buttons">
      <a href="signin.html" class="btn-outline">Sign In</a>
      <a href="signup.html" class="btn-filled">Join Free</a>
    </div>
  </div>

  <nav class="nav-links">
    <a href="dashboard.html">List Your Surplus</a>
    <a href="how-it-works.html">How It Works</a>
    <a href="resources.html">Resources</a>
    <a href="contact-dispute-accordion.html">Contact Us</a>
  </nav>

  <h1>Browse Listings</h1>
  <p class="subtitle">Find high-quality surplus inventory from trusted suppliers.</p>
</header>

<div class="search-bar">
  <input type="text" id="searchInput" placeholder="Search for products or services">
  <button onclick="renderListings()">üîç</button>
</div>

<div class="filter-tabs">
  <div class="tab active" onclick="filterCategory('', event)">All Categories</div>
  <div class="tab" onclick="filterCategory('Healthcare', event)">Healthcare</div>
  <div class="tab" onclick="filterCategory('Manufacturing', event)">Industrial</div>
  <div class="tab" onclick="filterCategory('Retail', event)">Apparel</div>
</div>

<div class="grid" id="listingsContainer"></div>
</div>

<div class="lightbox" id="lightbox">
  <span class="close" onclick="closeLightbox()">√ó</span>
  <button class="nav prev" onclick="prevImg()">‚Äπ</button>
  <img id="lightboxImg">
  <button class="nav next" onclick="nextImg()">‚Ä∫</button>
</div>

<footer>
  <div class="container footer-content">
    <div class="footer-links">
      <a href="#">About Us</a>
      <a href="#">Terms</a>
      <a href="#">Privacy</a>
      <a href="#">FAQ</a>
    </div>
    <div class="copyright">
      ¬© 2025 B2B Surplus. All rights reserved.
    </div>
  </div>
</footer>

<!-- ===== FIREBASE (PUBLIC READ) ===== -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCrbAWZAiUuIfhwrPC0xa8WPTsVGJWDy1c",
  authDomain: "business2business-67222.firebaseapp.com",
  projectId: "business2business-67222",
  storageBucket: "business2business-67222.firebasestorage.app",
  messagingSenderId: "913722719592",
  appId: "1:913722719592:web:9d54f832b102e4d842aadd"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let allListings = [];
let currentFilter = '';
let currentImages = [];
let currentImgIdx = 0;

const placeholders = [
  'dental-chair.jpeg',
  'industrial-mixer.jpeg',
  'hospital-bed.jpeg',
  'refrigerator.jpeg',
  'clothing-rack.jpeg',
  'wooden-shelving.jpeg'
];

function placeholder(i){ return placeholders[i % placeholders.length]; }

async function loadListings(){
  const snap = await getDocs(collection(db, "listings"));
  allListings = snap.docs.map(d => ({ id: d.id, ...d.data() }));
  renderListings();
}

window.renderListings = function(){
  const search = searchInput.value.toLowerCase();
  const filtered = allListings.filter(l =>
    (!currentFilter || l.sector === currentFilter) &&
    l.name.toLowerCase().includes(search)
  );

  listingsContainer.innerHTML = '';

  filtered.forEach((item,i)=>{
    const img = item.images?.[0] || placeholder(i);
    listingsContainer.innerHTML += `
      <div class="card">
        <div class="card-img">
          <img src="${img}" onclick="openLightbox(${i})">
        </div>
        <div class="card-body">
          <div class="card-title">${item.name}</div>
          <div class="card-meta">${item.sector} ‚Ä¢ ${item.condition} ‚Ä¢ Qty: ${item.quantity}</div>
          <div class="card-price">¬£${item.price}</div>
          <div class="card-footer">
            <span class="badge">Ultrasave</span>
            <button class="btn">View Details</button>
          </div>
        </div>
      </div>`;
  });
};

window.filterCategory = function(cat, e){
  currentFilter = cat;
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  e.target.classList.add('active');
  renderListings();
};

window.openLightbox = function(i){
  currentImages = allListings[i].images || [placeholder(i)];
  currentImgIdx = 0;
  lightboxImg.src = currentImages[0];
  lightbox.classList.add('active');
};

window.closeLightbox = () => lightbox.classList.remove('active');
window.prevImg = () => {
  currentImgIdx = (currentImgIdx-1+currentImages.length)%currentImages.length;
  lightboxImg.src = currentImages[currentImgIdx];
};
window.nextImg = () => {
  currentImgIdx = (currentImgIdx+1)%currentImages.length;
  lightboxImg.src = currentImages[currentImgIdx];
};

loadListings();
</script>

</body>
</html>